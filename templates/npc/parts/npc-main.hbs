<section class="tab {{tabs.npc.id}} {{tabs.npc.cssClass}} scrollable" id="npc" data-tab="{{tabs.npc.id}}"
    data-group="{{tabs.npc.group}}">
    <div class="resource-group-styled grid grid-5col">
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='agility'
        skillData=system.skills.agility}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='athletics'
        skillData=system.skills.athletics}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='wits'
        skillData=system.skills.wits}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='presence'
        skillData=system.skills.presence}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='intuition'
        skillData=system.skills.intuition}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='knowledge'
        skillData=system.skills.knowledge}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='resolve'
        skillData=system.skills.resolve}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='meleeCombat'
        skillData=system.skills.meleeCombat}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='rangedCombat'
        skillData=system.skills.rangedCombat}}
        {{> systems/arkham-horror-rpg-fvtt/templates/npc/parts/_skill.hbs skillKey='lore'
        skillData=system.skills.lore}}
    </div>
    <div class="grid grid-2col">
        <div>
            <fieldset>
                <legend>{{localize "ARKHAM_HORROR.LABELS.Knacks"}} <a class='item-control item-create' data-action="createNpcKnack"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.knack")}}'>
                        <i class='fas fa-plus'></i>
                    </a></legend>
                {{#each knacks as |knack|}}
                <div class="knack-entry">
                    <div>
                        <strong class="clickable" data-action="toggleFoldableContent"
                            data-fc-id="knack{{knack._id}}">{{knack.name}} </strong>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.knack")}}' data-item-id='{{knack._id}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.knack")}}' data-item-id='{{knack._id}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                    <div class="foldable-content" data-fc-id="knack{{knack._id}}">
                        {{{knack.system.description}}}
                    </div>
                </div>
                {{/each}}
            </fieldset>
        </div>

        <div>
            <fieldset>
                <legend>{{localize "ARKHAM_HORROR.LABELS.Weaknesses"}}
                    <a class='item-control item-create' data-action="createWeakness"
                        title='{{localize "DOCUMENT.Create" type=(localize "ARKHAM_HORROR.NPC.Weakness")}}'>
                        <i class='fas fa-plus'></i>
                    </a>
                </legend>
                {{#each weaknesses as |knack|}}
                <div class="knack-entry">
                    <div>
                        <strong class="clickable" data-action="toggleFoldableContent"
                            data-fc-id="weakness{{knack._id}}">{{knack.name}} </strong>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "ARKHAM_HORROR.NPC.Weakness")}}' data-item-id='{{knack._id}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "ARKHAM_HORROR.NPC.Weakness")}}' data-item-id='{{knack._id}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                    <div class="foldable-content" data-fc-id="weakness{{knack._id}}">
                        {{{knack.system.description}}}
                    </div>
                </div>
                {{/each}}
            </fieldset>

            <fieldset>
                <legend>
                    {{localize "ARKHAM_HORROR.LABELS.InjuriesTrauma"}}
                    <a class='item-control' data-action="clickedInjuryTraumaRoll" title="{{localize "ARKHAM_HORROR.ACTIONS.RollInjuryTrauma"}}" aria-label="{{localize "ARKHAM_HORROR.ACTIONS.RollInjuryTrauma"}}">
                        <i class="fa-solid fa-dice"></i>
                    </a>
                </legend>
                {{#each injuries as |injury|}}
                <div class="injury-entry">
                    <div>
                        <strong class="clickable" data-action="toggleFoldableContent" data-fc-id="injury{{injury._id}}">
                            {{#if (eq injury.type 'trauma')}}[{{localize "TYPES.Item.trauma"}}] {{/if}}
                            {{#if (eq injury.type 'injury')}}[{{localize "TYPES.Item.injury"}}] {{/if}}
                            {{injury.name}}</strong>
                        <a class='item-control item-edit' data-action="editItem" title='{{localize "DOCUMENT.Update" type=(localize (concat "TYPES.Item." injury.type))}}' data-item-id='{{injury._id}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize (concat "TYPES.Item." injury.type))}}' data-item-id='{{injury._id}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                    <div class="foldable-content" data-fc-id="injury{{injury._id}}">
                        {{{injury.system.description}}}
                    </div>
                </div>
                {{/each}}
            </fieldset>
        </div>

    </div>
    <div class="resource-group">
        <!-- Weapons -->
        <h5 class="quick-label">{{localize "ARKHAM_HORROR.LABELS.Weapons"}}</h5>
        <ol class='items-list'>
            <li class='item flexrow items-header'>
                <div class='item-name'>{{localize "ARKHAM_HORROR.PROPS.Name"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Skill"}}</div>
                <div class='item-prop damage-prop'>{{localize "ARKHAM_HORROR.PROPS.DamageShort"}}</div>
                <div class='item-prop injury-rating-prop'>{{localize "ARKHAM_HORROR.PROPS.InjuryRatingShort"}}</div>
                <div class="item-prop range-prop">{{localize "ARKHAM_HORROR.PROPS.Range"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Ammunition"}}</div>
                <div class='item-controls'>
                    <a class='item-control item-create' data-action="createItem"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.weapon")}}' data-type='weapon'>
                        <i class='fas fa-plus'></i>
                    </a>
                </div>
            </li>
            {{#each weapons as |item id|}}
            <li class='item ' data-item-id='{{item._id}}'>
                <div class="flexrow">
                    <div class='item-name clickable' data-action="toggleFoldableContent"
                        data-fc-id="weapon{{item._id}}">
                        <div class='item-image'>
                            <a class='rollable' data-roll-type='item'>
                                <img src='{{item.img}}' title='{{localize "ARKHAM_HORROR.TOOLTIPS.ExpandSpecialRules" itemName=item.name}}' width='24'
                                    height='24' />
                            </a>
                        </div>
                        {{item.name}}
                    </div>
                    <div class='item-prop clickable' data-action="clickedRollWithWeapon" data-item-id="{{item._id}}">{{localize (concat "ARKHAM_HORROR.SKILL." item.system.skill)}} <i class="fa-solid fa-dice"></i></div>
                    <div class='item-prop damage-prop'>{{item.system.damage}}</div>
                    <div class='item-prop injury-rating-prop'>{{item.system.injuryRating}}</div>
                    <div class='item-prop range-prop'>
                        {{#if (eq item.system.range 0)}}{{localize "ARKHAM_HORROR.PROPS.Engaged"}}{{else}}{{item.system.range}}{{/if}}
                    </div>
                    <div class='item-prop'><input type="text" value="{{item.system.ammunition.current}}"
                            data-item-stat="system.ammunition.current" class="item-editable-stat ammo_input"> /
                        {{item.system.ammunition.max}} <span class="weapon-reload-icon" data-item-id='{{item._id}}'
                            data-action="clickWeaponReload" title="{{localize "ARKHAM_HORROR.ACTIONS.Reload"}}" aria-label="{{localize "ARKHAM_HORROR.ACTIONS.Reload"}}"><i
                                class="fa-solid fa-rotate clickable"></i></span></div>
                    <div class='item-controls'>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.weapon")}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.weapon")}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                </div>
                <div class="foldable-content" data-fc-id="weapon{{item._id}}">
                    <div>
                        <strong>{{localize "ARKHAM_HORROR.PROPS.SpecialRules"}}:</strong>
                        {{{item.system.specialRules}}}
                    </div>
                </div>
            </li>
            {{/each}}
        </ol>
    </div>
    <div class="resource-group">
        <!-- Protective Equipment -->
        <h5 class="quick-label">{{localize "ARKHAM_HORROR.LABELS.ProtectiveEquipment"}}</h5>
        <ol class='items-list'>
            <li class='item flexrow items-header'>
                <div class='item-name'>{{localize "ARKHAM_HORROR.PROPS.Name"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Costs"}}</div>
                <div class='item-controls'>
                    <a class='item-control item-create' data-action="createItem"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.protective_equipment")}}' data-type='protective_equipment'>
                        <i class='fas fa-plus'></i>
                    </a>
                </div>
            </li>
            {{#each protectiveEquipments as |item id|}}
            <li class='item' data-item-id='{{item._id}}'>
                <div class="flexrow">
                    <div class='item-name clickable' data-action="toggleFoldableContent"
                        data-fc-id="protectiveEquipment{{item._id}}">
                        <div class='item-image'>
                            <a class='clickable' data-roll-type='item'>
                                <img src='{{item.img}}' title='{{item.name}}' width='24' height='24' />
                            </a>
                        </div>
                        <span>{{item.name}}</span>
                    </div>
                    <div class='item-prop'>{{formatCurrency item.system.cost}}</div>
                    <div class='item-controls'>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.protective_equipment")}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.protective_equipment")}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                </div>
                <div class="foldable-content" data-fc-id="protectiveEquipment{{item._id}}">
                    <div class="grid grid-2col">
                        <div>
                            <strong>{{localize "ARKHAM_HORROR.PROPS.DefensiveBenefit"}}:</strong>
                            {{{item.system.defensiveBenefit}}}
                        </div>
                        <div>
                            <strong>{{localize "ARKHAM_HORROR.PROPS.SpecialRules"}}:</strong>
                            {{{item.system.specialRules}}}
                        </div>
                    </div>
                </div>
            </li>
            {{/each}}
        </ol>
    </div>
    <div class="resource-group">
        <!-- Spells -->
        <h5 class="quick-label">{{localize "ARKHAM_HORROR.LABELS.Spells"}}</h5>
        <ol class='items-list'>
            <li class='item flexrow items-header'>
                <div class='item-name'>{{localize "ARKHAM_HORROR.PROPS.Name"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Skill"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Difficulty"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Range"}}</div>
                <div class='item-controls'>
                    <a class='item-control item-create' data-action="createItem"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.spell")}}' data-type='spell'>
                        <i class='fas fa-plus'></i>
                    </a>
                </div>
            </li>
            {{#each spells as |item id|}}
            <li class='item' data-item-id='{{item._id}}'>
                <div class="flexrow">
                    <div class='item-name clickable' data-action="toggleFoldableContent" data-fc-id="spell{{item._id}}">
                        <div class='item-image'>
                            <a class='clickable' data-roll-type='item'>
                                <img src='{{item.img}}' title='{{item.name}}' width='24' height='24' />
                            </a>
                        </div>
                        <span>{{item.name}}</span>
                    </div>
                    <div class="item-prop clickable" data-action="clickedRollWithSpell" data-item-id="{{item.id}}" data-skill-key="{{item.system.skill}}">{{localize (concat "ARKHAM_HORROR.SKILL." item.system.skill)}} <i class="fa-solid fa-dice"></i></div>
                    <div class='item-prop'>
                        {{#if (eq item.system.difficulty 1)}}{{localize "ARKHAM_HORROR.DIFFICULTY.Normal"}}
                        {{else if (eq item.system.difficulty 2)}}{{localize "ARKHAM_HORROR.DIFFICULTY.Difficult"}}
                        {{else if (eq item.system.difficulty 3)}}{{localize "ARKHAM_HORROR.DIFFICULTY.VeryDifficult"}}
                        {{/if}}
                    </div>
                    <div class='item-prop'>{{item.system.range}}</div>
                    <div class='item-controls'>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.spell")}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.spell")}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                </div>
                <div class="foldable-content" data-fc-id="spell{{item._id}}">
                    <div>
                        {{{item.system.specialRules}}}
                    </div>
                </div>
            </li>
            {{/each}}
        </ol>
    </div>
    <div class="resource-group">
        <!-- Useful Items -->
        <h5 class="quick-label">{{localize "ARKHAM_HORROR.LABELS.UsefulItems"}}</h5>
        <ol class='items-list'>
            <li class='item flexrow items-header'>
                <div class='item-name'>{{localize "ARKHAM_HORROR.PROPS.Name"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Costs"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Uses"}}</div>
                <div class='item-controls'>
                    <a class='item-control item-create' data-action="createItem"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.useful_item")}}' data-type='useful_item'>
                        <i class='fas fa-plus'></i>
                    </a>
                </div>
            </li>
            {{#each usefulItems as |item id|}}
            <li class='item' data-item-id='{{item._id}}'>
                <div class="flexrow">
                    <div class='item-name clickable' data-action="toggleFoldableContent"
                        data-fc-id="usefulItem{{item._id}}">
                        <div class='item-image'>
                            <a class='clickable' data-roll-type='item'>
                                <img src='{{item.img}}' title='{{item.name}}' width='24' height='24' />
                            </a>
                        </div>
                        <span>{{item.name}}</span>
                    </div>
                    <div class='item-prop'>{{formatCurrency item.system.cost}}</div>
                    <div class="item-prop"><input type="text" value="{{item.system.uses.current}}"
                            data-item-stat="system.uses.current" class="item-editable-stat ammo_input"> /
                        {{item.system.uses.max}}</div>
                    <div class='item-controls'>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.useful_item")}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.useful_item")}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                </div>
                <div class="foldable-content" data-fc-id="usefulItem{{item._id}}">
                    <div>
                        <strong>{{localize "ARKHAM_HORROR.PROPS.SpecialRules"}}:</strong>
                        {{{item.system.specialRules}}}
                    </div>
                </div>
            </li>
            {{/each}}
        </ol>
    </div>
    <div class="resource-group">
        <!-- Other Equipment -->
        <h5 class="quick-label">{{localize "ARKHAM_HORROR.LABELS.OtherEquipment"}}</h5>
        <ol class='items-list'>
            <li class='item flexrow items-header'>
                <div class='item-name'>{{localize "ARKHAM_HORROR.PROPS.Name"}}</div>
                <div class='item-prop'>{{localize "ARKHAM_HORROR.PROPS.Costs"}}</div>
                <div class='item-controls'>
                    <a class='item-control item-create' data-action="createOtherEquipment"
                        title='{{localize "DOCUMENT.Create" type=(localize "TYPES.Item.useful_item")}}'>
                        <i class='fas fa-plus'></i>
                    </a>
                </div>
            </li>
            {{#each otherEquipment as |item id|}}
            <li class='item' data-item-id='{{item._id}}'>
                <div class="flexrow">
                    <div class='item-name clickable' data-action="toggleFoldableContent"
                        data-fc-id="otherEquipment{{item._id}}">
                        <div class='item-image'>
                            <a class='clickable' data-roll-type='item'>
                                <img src='{{item.img}}' title='{{item.name}}' width='24' height='24' />
                            </a>
                        </div>
                        <span>{{item.name}}</span>
                    </div>
                    <div class='item-prop'>{{#if item.system.costs}}{{item.system.costs}}{{else}}{{formatCurrency item.system.cost}}{{/if}}</div>
                    <div class='item-controls'>
                        <a class='item-control item-edit' data-action="editItem"
                            title='{{localize "DOCUMENT.Update" type=(localize "TYPES.Item.useful_item")}}'>
                            <i class='fas fa-edit'></i>
                        </a>
                        <a class='item-control item-delete' data-action="deleteItem"
                            title='{{localize "DOCUMENT.Delete" type=(localize "TYPES.Item.useful_item")}}'>
                            <i class='fas fa-trash'></i>
                        </a>
                    </div>
                </div>
                <div class="foldable-content" data-fc-id="otherEquipment{{item._id}}">
                    <div>
                        <strong>{{localize "ARKHAM_HORROR.LABELS.Description"}}:</strong>
                        {{{item.system.description}}}
                    </div>
                </div>
            </li>
            {{/each}}
        </ol>
    </div>
</section>