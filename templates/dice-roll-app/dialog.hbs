<form class="roll-dialog-container scrollable">
    <div class="form-group">
        <label for="dicepool">{{localize "ARKHAM_HORROR.LABELS.Dicepool"}}</label>
        <div class="flexrow">
            <button class="button-dicepool-rolldialog" data-action="clickedDecreaseDicePool" {{#if isReaction}}disabled{{/if}}>-</button>
            <input type="number" id="dicepool" name="diceToUse" value="{{diceToUse}}" min="0" {{#if isReaction}}readonly{{/if}}> / 
            <input type="number" name="currentDicePool" value="{{currentDicePool}}" min="0" readonly>
            <button class="button-dicepool-rolldialog" data-action="clickedIncreaseDicePool" {{#if isReaction}}disabled{{/if}}>+</button>
        </div>
    </div>
    <div class="form-group">
        <label for="roll-kind">{{localize "ARKHAM_HORROR.PROPS.RollType"}}</label>
        <input type="text" id="roll-kind" name="rollKindLabel" value="{{rollKindLabel}}" readonly>
    </div>
    <div class="form-group">
        <label for="skill-key">{{localize "ARKHAM_HORROR.PROPS.Skill"}}</label>
        {{#if isSkillSelectable}}
        <select id="skill-key" name="skillKey">
            {{#each skillChoices as |choice|}}
            <option value="{{choice.key}}" {{#if (eq ../skillKey choice.key)}}selected{{/if}}>{{choice.label}}</option>
            {{/each}}
        </select>
        {{else}}
        <input type="text" id="skill-key" name="skillKeyLabel" value="{{localize (concat "ARKHAM_HORROR.SKILL." skillKey)}}" readonly>
        {{/if}}
    </div>
    <div class="form-group">
        <label for="skill-current">{{localize "ARKHAM_HORROR.PROPS.SuccessOnXPlus"}}</label>
        <input type="number" id="skill-current" name="skillCurrent" value="{{skillCurrent}}" min="0">
    </div>
    <div class="form-group">
        <label for="bonus_dice">{{localize "ARKHAM_HORROR.PROPS.BonusDice"}}</label>
        <input type="number" id="bonus_dice" name="bonus_dice" value="{{bonus_dice}}" min="0">
    </div>
    <div class="form-group">
        <label for="penalty">{{localize "ARKHAM_HORROR.PROPS.Penalty"}}</label>
        <input type="number" id="penalty" name="penalty" value="{{penalty}}" min="0">
    </div>
    <div class="form-group">
        <label for="result-modifier">{{localize "ARKHAM_HORROR.PROPS.ResultModifier"}}</label>
        <input type="number" id="result-modifier" name="resultModifier" value="{{resultModifier}}" min="0" max="6" step="1">
    </div>
    <div class="form-group">
        <label for="difficulty">{{localize "ARKHAM_HORROR.PROPS.Difficulty"}}</label>
        <select id="difficulty" name="difficulty">
            <option value="1" {{#if (eq successesNeeded 1)}}selected{{/if}}>{{localize "ARKHAM_HORROR.DIFFICULTY.Normal"}}</option>
            <option value="2" {{#if (eq successesNeeded 2)}}selected{{/if}}>{{localize "ARKHAM_HORROR.DIFFICULTY.Difficult"}}</option>
            <option value="3" {{#if (eq successesNeeded 3)}}selected{{/if}}>{{localize "ARKHAM_HORROR.DIFFICULTY.VeryDifficult"}}</option>
        </select>
    </div>
    <div class="form-group">
        <label for="modifier">{{localize "ARKHAM_HORROR.PROPS.Advantage"}}</label>
        <select id="modifier" name="advantageModifier">
            <option value="0" {{#if (eq modifierAdvantage 0)}}selected{{/if}}>{{localize "ARKHAM_HORROR.Dialog.DiceRoll.None"}}</option>
            <option value="1" {{#if (eq modifierAdvantage 1)}}selected{{/if}}>{{localize "ARKHAM_HORROR.PROPS.Advantage"}}</option>
            <option value="2" {{#if (eq modifierAdvantage 2)}}selected{{/if}}>{{localize "ARKHAM_HORROR.PROPS.Disadvantage"}}</option>
            <option value="3" {{#if (eq modifierAdvantage 3)}}selected{{/if}}>{{localize "ARKHAM_HORROR.Dialog.DiceRoll.AdvPlusDisadv"}}</option>
        </select>
    </div>
    {{#if weaponToUse}}
    <div class="form-group">
        <label for="weapon-to-use">{{localize "ARKHAM_HORROR.PROPS.Weapon"}}</label>
        <input type="text" id="weapon-to-use" name="weaponToUse" value="{{weaponToUse.name}}" readonly>
    </div>
    {{/if}}
    {{#if spellToUse}}
    <div class="form-group">
        <label for="spell-to-use">{{localize "ARKHAM_HORROR.PROPS.Spell"}}</label>
        <input type="text" id="spell-to-use" name="spellToUse" value="{{spellToUse.name}}" readonly>
    </div>
    {{/if}}

    <footer class="dialog-footer dialog-footer--primary">
        <button type="button" class="roll-button" data-action="clickedRoll"><i class="fa-solid fa-dice"></i> {{localize "ARKHAM_HORROR.ACTIONS.Roll"}}</button>
    </footer>

    {{#if knackChoices}}
    <hr />
    <div class="form-group knack-choices">
        <label>{{localize "ARKHAM_HORROR.LABELS.Knacks"}}</label>
        <div class="notes">{{localize "ARKHAM_HORROR.Dialog.DiceRoll.KnacksHint"}}</div>

        {{#if knackPreview.hasSelection}}
        <div class="knack-preview">
            <div class="knack-preview__title">{{localize "ARKHAM_HORROR.Dialog.DiceRoll.SelectedEffects"}}</div>
            <div class="knack-preview__text">{{knackPreview.text}}</div>
        </div>
        {{/if}}

        {{#each knackChoices as |k|}}
        <div class="flexrow knack-choice-row {{#if k.checked}}is-checked{{/if}} {{#if k.disabled}}is-disabled{{/if}}">
            <input type="checkbox" name="selectedKnackIds" value="{{k.id}}" {{#if k.checked}}checked{{/if}} {{#if k.disabled}}disabled{{/if}}>
            <span>
                {{localize "ARKHAM_HORROR.Dialog.DiceRoll.Tier" tier=k.tier}} - {{k.name}}
                {{#if k.effect}}
                    <span class="knack-effect">— {{k.effect.text}}</span>
                {{/if}}
                {{#if k.availabilityNote}}
                    <span class="knack-availability">— {{k.availabilityNote}}</span>
                {{/if}}
                <small class="notes">
                    ({{k.frequency}}
                    {{#if (eq k.frequency "passive")}}
                    {{else}}
                        {{#if (eq k.frequency "unlimited")}}
                        {{else}}
                            : {{k.remaining}}/{{k.max}}
                        {{/if}}
                    {{/if}})
                </small>
            </span>

            {{#if k.showRefresh}}
            <button type="button" class="knack-refresh" data-action="refreshKnackUses" data-item-id="{{k.id}}" title="{{localize "ARKHAM_HORROR.Dialog.DiceRoll.RefreshUses"}}" aria-label="{{localize "ARKHAM_HORROR.Dialog.DiceRoll.RefreshUses"}}">
                <i class="fas fa-rotate-right"></i>
            </button>
            {{/if}}
        </div>
        {{/each}}
    </div>
    {{/if}}
</form>